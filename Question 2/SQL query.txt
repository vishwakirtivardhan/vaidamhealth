select status, sum(CASE WHEN DATEDIFF( CURRENT_DATE(), updated_at) = 0 THEN 1 ELSE 0 END) as 'Today', sum(CASE WHEN DATEDIFF( CURRENT_DATE(), updated_at) = 1 THEN 1 ELSE 0 END) as 'Yesterday', sum(CASE WHEN DATEDIFF( CURRENT_DATE(), updated_at) < 7 THEN 1 ELSE 0 END) as 'in Last 7 Days', sum(CASE WHEN DATEDIFF( CURRENT_DATE(), updated_at) < 31 THEN 1 ELSE 0 END) as 'in Last 30 Days' from fallup group by status
